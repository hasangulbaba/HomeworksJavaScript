<!DOCTYPE html>
<html>
<head>
 <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
<link rel="stylesheet" type="text/css" href="site_theme.css">
<meta charset="UTF-8"/>

<title>Website Project</title>
<script src="database.js"></script>

<nav>
  <ul class="nav">
    <li><a href="#" style="float:initial;">ANASAYFA</a></li>
    <li><a href="#">KATEGORİ</a>
      <ul>
        <li><a href="#">KONUT</a>
	<ul>
            <li><a href="#">SATILIK</a></li>
            <li><a href="#">KİRALIK</a></li>
            <li><a href="#">GÜNLÜK KİRALIK</a></li>
        </ul>
	</li>
        <li><a href="#">İŞYERİ</a>
	<ul>
            <li><a href="#">SATILIK</a></li>
            <li><a href="#">KİRALIK</a></li>
        </ul>
	</li>
        <li><a href="#" onClick="showLinkElements('a')">ARSA</a>
	<ul>
            <li><a href="#">SATILIK</a></li>
            <li><a href="#">KİRALIK</a></li>
        </ul>
	</li>
        <li><a href="#">BİNA</a>
	<ul>
            <li><a href="#">SATILIK</a></li>
            <li><a href="#">KİRALIK</a></li>
        </ul>
	</li>
      </ul>
    </li>
    <li><a href="#" id="button_search" onClick="searchingVisibility()">ARAMA</a></li>
    <li><a href="#">YARDIM</a></li>
    <li><a href="#">HAKKIMIZDA</a></li>
    <li><a href="#">İLETİŞİM</a></li>
  </ul>
</nav><br>
<script>
function searchingVisibility() {
	var searching = document.getElementById("input_search");
	searching.style.visibility = "visible";
}
function searchingVisibilityHidden() {
	var searching_input = document.getElementById("input_search");
	searching_input.style.visibility = "hidden";
}
</script>
</head>
<body>
<form >
	<center style="visibility:hidden;" id="input_search">
	  	<input  type="text" name="search" placeholder="Search.."><br>
		<fieldset style="width:35%;">
			<div class="item">
		    		<input type="checkbox" id="a">
		    		<label for="a">Satılık</label>&nbsp;&nbsp;
				<input type="checkbox" id="b">
		    		<label for="b">Kiralık</label>&nbsp;&nbsp;
		    		<input type="checkbox" id="c">
		    		<label for="c">Günlük Kiralık</label>&nbsp;&nbsp;
			</div>
		</fieldset>
	</center>
</form><br>
<center>
<div id="myTable" style="display:inline;">
</div>
</center>

<script>
const database = new Database();
const url = "https://sameteraslan.github.io/HomeworksJavaScript/MyProject/text_files/";
function readData(file) {
    console.log("readData "+file);
    if(file.includes("konut.txt")) {
      fetch(url+file)
          .then(r => r.text())
          .then(addKonut).then(showKonutElements);
    } 
    else if(file.includes("isyeri.txt")) {
      fetch(url+file)
          .then(r => r.text())
          .then(addIsyeri).then(showIsyeriElements);
    }
    else if(file.includes("bina.txt")) {
      fetch(url+file)
          .then(r => r.text())
          .then(addBina).then(showBinaElements);
    } 
    else if(file.includes("arsa.txt")) {
      fetch(url+file)
          .then(r => r.text())
          .then(addArsa).then(showArsaElements);
    } 
    else {
	console.log("File could not find.")
    }
}
function parse(line) {
    let b = line.split("\t");
    return b;
}
function addKonut(txt) {
    let a = txt.split("\n");
    for (let s of a) {
		let std = parse(s);
		database.konut.set(std[0], [std[1], std[2], std[3], std[4], std[5], std[6]]);
    }
}
function addIsyeri(txt) {
    let a = txt.split("\n");
    for (let s of a) {
		let std = parse(s);
		database.isyeri.set(std[0], [std[1], std[2], std[3], std[4], std[5], std[6]]);
    }
}
	
	
function addArsa(txt) {
    let a = txt.split("\n");
    for (let s of a) {
		let std = parse(s);
		database.arsa.set(std[0], [std[1], std[2], std[3], std[4], std[5], std[6]]);
    }
}
	
function addBina(txt) {
    let a = txt.split("\n");
    for (let s of a) {
		let std = parse(s);
		database.bina.set(std[0], [std[1], std[2], std[3], std[4], std[5], std[6]]);
    }
}
readData("konut.txt");
readData("arsa.txt");
readData("bina.txt");
readData("isyeri.txt");
function showKonutElements() {
    let row = "";
    for (let b of database.konut.keys()) {
	    row += '<div id="' + b + '' + database.konut.get(b)[0] + '" class="card"><img src="' + database.konut.get(b)[1]  + '" style="width:100%"> <h2 style="min-height:200px">' + database.konut.get(b)[3] + '</h2><p class="price">' + database.konut.get(b)[2] + ' TL</p><p>' + database.konut.get(b)[4] + '</p> <p><button>İncele</button></p></div>';   
    }
    myTable.innerHTML += row;
}

function showArsaElements() {
    let row = "";
    for (let b of database.arsa.keys()) {
	    row += '<div id="' + b + '' + database.arsa.get(b)[0] + '" class="card"><img src="' + database.arsa.get(b)[1]  + '" style="width:100%"> <h2 style="min-height:200px">' + database.arsa.get(b)[3] + '</h2><p class="price">' + database.arsa.get(b)[2] + ' TL</p><p>' + database.arsa.get(b)[4] + '</p> <p><button>İncele</button></p></div>';   
    }
    myTable.innerHTML += row;
}

function showBinaElements() {
    let row = "";
    for (let b of database.bina.keys()) {
	    row += '<div id="' + b + '' + database.bina.get(b)[0] + '" class="card"><img src="' + database.bina.get(b)[1]  + '" style="width:100%"> <h2 style="min-height:200px">' + database.bina.get(b)[3] + '</h2><p class="price">' + database.bina.get(b)[2] + ' TL</p><p>' + database.bina.get(b)[4] + '</p> <p><button>İncele</button></p></div>';   
    }
    myTable.innerHTML += row;
}

function showIsyeriElements() {
    let row = "";
    for (let b of database.isyeri.keys()) {
	    row += '<div id="' + b + '' + database.isyeri.get(b)[0] + '" class="card"><img src="' + database.isyeri.get(b)[1]  + '" style="width:100%"> <h2 style="min-height:200px">' + database.isyeri.get(b)[3] + '</h2><p class="price">' + database.isyeri.get(b)[2] + ' TL</p><p>' + database.isyeri.get(b)[4] + '</p> <p><button>İncele</button></p></div>';   
    }
    myTable.innerHTML += row;
}

function sorgula(aranacak_metin) {
    let row = "";
    for (let b of database.isyeri.keys()) {
	    console.log("deneme");
	    if (database.isyeri.get(b).includes(aranacak_metin))
	    	row += '<div id="' + b + '' + database.isyeri.get(b)[0] + '" class="card"><img src="' + database.isyeri.get(b)[1]  + '" style="width:100%"> <h2 style="min-height:200px">' + database.isyeri.get(b)[3] + '</h2><p class="price">' + database.isyeri.get(b)[2] + ' TL</p><p>' + database.isyeri.get(b)[4] + '</p> <p><button>İncele</button></p></div>';   
    }
    myTable.innerHTML = row;
    console.log(myTable.innerHTML);
}

function showLinkElements(aranacak_metin) {
    let row = "";
    for (let b of database.isyeri.keys()) {
	    if (database.isyeri.get(b).includes(aranacak_metin))
	    	row += '<div id="' + b + '' + database.isyeri.get(b)[0] + '" class="card"><img src="' + database.isyeri.get(b)[1]  + '" style="width:100%"> <h2 style="min-height:200px">' + database.isyeri.get(b)[3] + '</h2><p class="price">' + database.isyeri.get(b)[2] + ' TL</p><p>' + database.isyeri.get(b)[4] + '</p> <p><button>İncele</button></p></div>';   
    }
    console.log("aboooo");
    myTable.innerHTML = row;
    console.log(myTable.innerHTML);


}
setTimeout(console.log, 3000, database.konut);
</script>

</body>
</html>
